<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">

    <title>Test</title>
    <script>
        async function login() {
            const id = document.getElementById('id').value;
            const password = document.getElementById('password').value;

            let response = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 'id': id, 'password': password })
            });

            let data = await response.text(); //토큰 획득
            if (data == 'fail') {
                alert("로그인 실패");
            }
            else {
                alert("로그인 성공" + data);
                document.cookie = `jwt=${data}`;
                check();

            }

        }

        async function check() {
            console.log(getCookie('jwt'));
            let response = await fetch('/check_login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 'jwt': getCookie('jwt') })
            });

            let data = await response.text();
            alert(data);
        }
    </script>

    <style>
        .container {
            width: 50%;
            align-content: center;
            align-content: center;
            margin-top: 100px;

        }
        
    </style>
</head>

<body>
    
    <div class="container">
        <h1 class="title is-1">SW정글 우리의 공통점!? 로그인</h1>

        <div class="field">
            <label class="label">ID</label>
            <div class="control has-icons-left has-icons-right">
                <input class="input is-success" type="text" placeholder="ID를 입력하세요" value="">
                <span class="icon is-small is-left">
                    <i class="fas fa-user"></i>
                </span>
                <span class="icon is-small is-right">
                    <i class="fas fa-check"></i>
                </span>
            </div>
        </div>

        <div class="field">
            <label class="label">Password</label>
            <div class="control has-icons-left has-icons-right">
                <input class="input is-danger" type="password" placeholder="패스워드를 입력하세요" value="">
                <span class="icon is-small is-left">
                    <i class="fas fa-envelope"></i>
                </span>
                <span class="icon is-small is-right">
                    <i class="fas fa-exclamation-triangle"></i>
                </span>
            </div>
            <!-- <p class="help is-danger">This email is invalid</p> -->
        </div>


        <div class="field is-grouped">
            <div class="control">
                <button class="button is-link" onclick="login()">로그인하기</button>
            </div>
            <div class="control">
                <button class="button is-link is-light" onclick="check()">확인</button>
            </div>
        </div>
    </div>





</body>

</html>